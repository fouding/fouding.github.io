<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://foudingzheng.info">
  <title>Fouding&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Fouding's Blog">
<meta property="og:url" content="http://foudingzheng.info/index.html">
<meta property="og:site_name" content="Fouding's Blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fouding's Blog">
  
    <link rel="alternative" href="/atom.xml" title="Fouding&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/main.css?v=4.0.0.css">
  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/assets/img/avatar.png" class="js-avatar">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">foudingzh</a></h1>
		</hgroup>

		
		<p class="header-subtitle">知道行德</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/mgmt">管理</a></li>
	        
				<li><a href="/tags/tech">技术</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a data-idx="0" q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a data-idx="1" q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友情链接</a>
    			
    			
            
    			
    			<a data-idx="2" q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/fouding" title="github"><i class="icon-github"></i></a>
		        
					<a class="mail" target="_blank" href="mailto:fouding_zheng[at]outlook.com" title="mail"><i class="icon-mail"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-sort"></i></div>
  		<h1 class="header-author js-mobile-header hide">foudingzh</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/assets/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">foudingzh</h1>
			</hgroup>
			
			<p class="header-subtitle">知道行德</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/tags/mgmt">管理</a></li>
		        
					<li><a href="/tags/tech">技术</a></li>
		        
		        
		        	<li><a href="/archives/">所有文章</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/fouding" title="github"><i class="icon-github"></i></a>
			        
						<a class="mail" target="_blank" href="mailto:fouding_zheng[at]outlook.com" title="mail"><i class="icon-mail"></i></a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-pm-summary" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/pm-summary/">研发与技术管理小结</a>
    </h1>
  

        <a href="/2016/03/pm-summary/" class="archive-article-date">
  	<time datetime="2016-03-28T02:20:05.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-03-28</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>创业公司研发部较少有纯管理性的职位，一般要身兼核心模块框架开发和团队管理的职责。这就要求负责人有较深的技术背景，上马能写核心模块，下马能指导成员遇到的遇到难题，建立起技术上的威信；管理上刚柔并济，让人心服。</p>
<p>在创业公司负责了几年的技术研发和管理，有自己的一点小心得，会陆续放在博客上来。</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在 Infosys 学到的要点： <em>methodologies</em>, <em>process</em>, <em>code standard/checklist</em>。</p>
<p>先说说贯穿于整个工作中的“团队建设”、“任务排期”、“文档协作”和“绩效考核”。</p>
<h3 id="团队建设"><a href="#团队建设" class="headerlink" title="团队建设"></a>团队建设</h3><p>公司，尤其是创业公司，最重要的是人，包括市场部人员、研发部人员和后勤人员等。<br>要保持团队，尤其是核心成员的稳定性，不仅在待遇上处于业界中上水平，还须在团队氛围和技能提升上让成员觉得这是一个好的队伍，值得一起共事。</p>
<p>定位：服务于研发团队，给一线团队创造一个良好的工作环境。在内，创造令人愉快的环境和氛围；公司内，协调好与市场、后勤等其他部门的关系，包括为团队向公司争取应得的利益，也为</p>
<ul>
<li>团队氛围：开放、互助</li>
<li>技术提升：构建内部的技术 wiki 并建立技术分享机制</li>
<li>管理能力提升，同时建立起人才梯队</li>
<li>团队活动<ul>
<li>饭后大家一起散步聊天（是真的散步-_-），是很好的方式</li>
<li>公司里没健身场地和器材，就在公司附近的健身场订了长期的羽毛球场地，每周三下班后一起去打球</li>
<li>一月一次的聚餐</li>
<li>提议中的家属日（尚未执行）</li>
</ul>
</li>
</ul>
<h3 id="任务排期"><a href="#任务排期" class="headerlink" title="任务排期"></a>任务排期</h3><p>排期：预估开发周期，制定项目开发进度，分解任务，分配任务。</p>
<ul>
<li>方法：WBS</li>
<li>工具：看板模式，如 Worktile；</li>
<li>开发周期的预估很大程序上取决于负责人以前的经验。</li>
<li>分配任务时需分配到具体负责人，要有优先级、检查项、deadline。</li>
<li>了解每人性格、技术特点，从而匹配相关任务，并使其逐步提升。</li>
</ul>
<h3 id="文档协作"><a href="#文档协作" class="headerlink" title="文档协作"></a>文档协作</h3><p>创业公司不会按传统的研发流程按步就班地进行，更多强调的是快速开发。不仅非研发人员（老板，市场部等）不关注研发过程中的文档，连研发人员也很多对文档写作有排斥心理，认为写好代码，程序能跑就好了。<br>的确，传统方式中的文档太多了，而且写了以后也不一定有人去看。<br>但敏捷开发强调的是快速试错、快速迭代，而非简单粗暴，<em>对比传统开发模型虽然并不强调文档，但并不代表不需要</em>。对于一个项目，从开始就需要需求文档、产品原型文档、项目进度文档等等，而到了研发这一步，在系统实现、写代码之前最好的就是先”想”再做，而”想”的一种比较好的输出形式就是文档。对于一个软件系统，一般来说需要写的文档有以下几种：</p>
<ul>
<li>系统业务流程文档：描述系统业务逻辑的文档，能清晰的说明真个业务的流程。</li>
<li>系统架构设计文档：对整个系统的架构的描述，需要包含系统的各个关键组成模块以及相关的各个关键技术点等。</li>
<li>系统功能模块概要设计/详细设计文档：对于某一个模块的流程、逻辑的描述。</li>
<li>数据DDL/DML文档: 与系统相关的数据库的DDL和DML文档，对于前者，是需要包含所有的操作的，而对于后者，必不可少的是查询语句，用来提供给DBA，来做查询sql的review，以保证索引的正确建立和查询语句的合理等。</li>
<li>系统部署文档：描述系统关键部分部署在哪里，需要做哪些配置。</li>
<li>系统发布ChangeLog：对系统每次发布的改动进行描述，包括数据库、缓存、数据队列、新增/变动了哪些依赖服务等。此外，对数据库、缓存这种关键服务的量化分析也可以写在这里。</li>
</ul>
<p>使用的工具可以是 WORD, Markdown 或在线协作工具。我推崇的格式是 markdown，比 WORD 文档更适合团队协作和版本追踪。Markdown 工具很多，可用 <a href="http://pad.haroopress.com/" target="_blank" rel="external">haroopad</a>, <a href="https://pandao.github.io/editor.md" target="_blank" rel="external">pandao editor</a> 等</p>
<p>文档的范例可参见<a href="https://github.com/superhj1987/awesome-tech-collections/tree/master/document" target="_blank" rel="external">这里</a>。</p>
<h3 id="绩效考核"><a href="#绩效考核" class="headerlink" title="绩效考核"></a>绩效考核</h3><ul>
<li>绩效指标的确定：分职位，分阶段确定不同的指标。</li>
</ul>
<h2 id="Phases-研发各阶段"><a href="#Phases-研发各阶段" class="headerlink" title="Phases 研发各阶段"></a>Phases 研发各阶段</h2><p>梳理各阶段的角色、任务和工具链。</p>
<h3 id="Req-需求调研"><a href="#Req-需求调研" class="headerlink" title="Req 需求调研"></a>Req 需求调研</h3><p>需求梳理、分析是产品研发的前期阶段，易被忽略但极为重要的阶段。一个不符合市场需求的产品推倒重来，浪费的是研发人员的时间和公司在市场上的时机和表现。</p>
<ul>
<li>需求调研：产品经理做需求调研，确定产品需求，编写需求文档（一张产品功能脑图或者一份功能列表），完成产品原型（手绘草图即可）<br>需求的来源可能来自客户、老板和市场部。<br>创业公司不一定有专职的产品经理，可能由技术负责人/研发人员同时兼任了。</li>
<li>原型设计：产品人员根据原型设计出一系列 UI 界面，包括产品业务流程图、交互原型。</li>
<li>需求评审：产品经理召集产品、UI、开发、测试等人员召开需求评审会议，确定最终产品的界面和交互。</li>
<li>工具：纸笔，<a href="https://modao.cc" target="_blank" rel="external">墨刀</a></li>
</ul>
<h3 id="Design-设计及文档产出"><a href="#Design-设计及文档产出" class="headerlink" title="Design 设计及文档产出"></a>Design 设计及文档产出</h3><ul>
<li>概要设计和详细设计。很多时候详细设计都省略了，但基本的概要设计还是要的，包括：<ul>
<li>架构文档</li>
<li>流程图。 UML工具：<a href="http://staruml.io" target="_blank" rel="external">StarUML</a>, <a href="http://www.processon.com" target="_blank" rel="external">ProcessOn</a></li>
</ul>
</li>
<li>API 接口文档。 <a href="https://github.com/thx/RAP" target="_blank" rel="external">阿里妈妈RAP</a> ，<a href="http://swagger.io" target="_blank" rel="external">Swagger</a></li>
</ul>
<h3 id="Dev-开发"><a href="#Dev-开发" class="headerlink" title="Dev 开发"></a>Dev 开发</h3><p>开发人员根据 UI 界面、需求文档和技术文档开始编写代码，开发模块上的功能。</p>
<h4 id="Code-Standard-Checklist-技术规范"><a href="#Code-Standard-Checklist-技术规范" class="headerlink" title="Code Standard / Checklist 技术规范"></a>Code Standard / Checklist 技术规范</h4><p>统一的技术规范和 checklist 利于团队协作，减少错误发生的可能性，增强可维护性。</p>
<ul>
<li>数据库规范</li>
<li>代码规范</li>
<li>接口规范</li>
<li>可用性检查列表</li>
<li>测试规范</li>
<li>安全规范</li>
</ul>
<h4 id="QA-质量保证"><a href="#QA-质量保证" class="headerlink" title="QA 质量保证"></a>QA 质量保证</h4><ul>
<li>Jenkins 静态分析：Findbugs；CheckStyle；单元测试覆盖率 &gt; 95%</li>
<li>Code Review 代码评审：每周一次的集体 Review</li>
<li>测试</li>
</ul>
<h4 id="Tools-使用的工具"><a href="#Tools-使用的工具" class="headerlink" title="Tools 使用的工具"></a>Tools 使用的工具</h4><ul>
<li>svn/git, Intellij Idea/Eclipse</li>
<li>前端框架<ul>
<li><a href="https://github.com/puikinsh/gentelella" target="_blank" rel="external">puikinsh/gentelella: Free Bootstrap 3 Admin Template</a></li>
<li><a href="https://github.com/almasaeed2010/AdminLTE" target="_blank" rel="external">almasaeed2010/AdminLTE: AdminLTE - Free Premium Admin control Panel Theme That Is Based On Bootstrap 3.x</a></li>
</ul>
</li>
<li>后端工具：<a href="http://projects.spring.io/spring-boot/" target="_blank" rel="external">Spring Boot CLI</a></li>
<li><a href="http://schemaspy.sourceforge.net" target="_blank" rel="external">SchemaSpy</a></li>
</ul>
<h4 id="细节"><a href="#细节" class="headerlink" title="细节"></a>细节</h4><ul>
<li>缓存</li>
<li>事务控制</li>
<li>安全</li>
<li>注重监控模块</li>
</ul>
<h3 id="Deploy-自动化部署"><a href="#Deploy-自动化部署" class="headerlink" title="Deploy 自动化部署"></a>Deploy 自动化部署</h3><ul>
<li>开发环境 -&gt; 测试环境 -&gt; mock 环境 -&gt; 线上环境</li>
<li>CI 工具：<a href="https://jenkins.io/index.html" target="_blank" rel="external">Jenkins</a></li>
</ul>
<h3 id="Testing-测试"><a href="#Testing-测试" class="headerlink" title="Testing 测试"></a>Testing 测试</h3><ul>
<li>功能测试</li>
<li>性能测试: ab, JMeter</li>
<li>安全性测试</li>
<li>集成测试</li>
<li>移动端自动化测试工具</li>
</ul>
<h4 id="Bug-管理"><a href="#Bug-管理" class="headerlink" title="Bug 管理"></a>Bug 管理</h4><ul>
<li>工具：使用的是 redmine. 官方安装较为繁琐，可使用 <a href="https://bitnami.com/stack/redmine" target="_blank" rel="external">bitnami redmine 安装包</a> 简易安装。</li>
</ul>
<h3 id="Go-Live-上线"><a href="#Go-Live-上线" class="headerlink" title="Go Live 上线"></a>Go Live 上线</h3><p>Release Checklist Document，包括数据库更改、最新运行包，部署时间与方式，注意点，验证检查项等等。</p>
<h3 id="devOps"><a href="#devOps" class="headerlink" title="devOps"></a>devOps</h3><ul>
<li>db backup</li>
<li>docker。团队里没有这方面的技术储备，不敢贸然上 docker。待研究。</li>
</ul>
<h3 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h3><ul>
<li>思维导图工具：<a href="https://www.mindjet.com" target="_blank" rel="external">MindManager</a>， <a href="http://naotu.baidu.com" target="_blank" rel="external">百度脑图</a>，<a href="http://www.xmind.net/" target="_blank" rel="external">XMind</a></li>
<li>即时沟通：<a href="https://bearychat.com" target="_blank" rel="external">BearyChat</a></li>
<li>移动办公app：<a href="http://jingoal.com" target="_blank" rel="external">今目标</a>（也是厦门企业），<a href="https://www.dingtalk.com" target="_blank" rel="external">阿里钉钉</a></li>
<li>其他：<a href="http://www.ghisler.com" target="_blank" rel="external">Total Commander</a>, <a href="http://www.vim.org" target="_blank" rel="external">gvim</a>, <a href="http://cmder.net" target="_blank" rel="external">cmder</a>, <a href="http://mobaxterm.mobatek.net/" target="_blank" rel="external">MobaXterm</a>, <a href="https://atom.io" target="_blank" rel="external">Atom</a>, <a href="https://nodejs.org" target="_blank" rel="external">node</a></li>
</ul>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>对未建立或未完善完整技术团队和体系的公司来说：</p>
<ul>
<li>组建核心技术团队。招聘到合适的人是件费时费心的事儿，团队磨合也是一个长期的过程。</li>
<li>统一技术规范、工具链</li>
<li>搭建开发/测试/预发布/生产各环境：svn/git repo; maven/gradle repo; redmine；Jenkins</li>
</ul>
<p>另外，这些是比较理想的流程，但创业公司因为时间、成本的原因，省去了很多流程，还有很多例外的情况，如开发倒逼需求，需求倒逼设计，不一而足，这要依实际情况调整了。这也是管理与开发的一大不同：对于机器，确定性、可预测性，而对于人性，则有更大的灵活性。但看着一个初步的 idea 在自己团队的努力下，变成一个可触及的产品，还是很有成就感的。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/24219376" target="_blank" rel="external">目标驱动的技术管理 - 软件工程师的自我修养 - 知乎专栏</a></li>
<li><a href="http://www.rowkey.me/blog/2016/08/17/dev-manage/" target="_blank" rel="external">研发体系这点事 - 后端技术杂谈 | 飒然Hang</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/21719921" target="_blank" rel="external">我有一个 App 创意丨如何将其实现？ - FenzoTech - 知乎专栏</a></li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dev-phases/">dev phases</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mgmt/">mgmt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/toolchain/">toolchain</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-book icon"></i>
	<a class="article-category-link" href="/categories/mgmt/">mgmt</a>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/03/pm-summary/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-docker-getting-feet-wet" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/docker-getting-feet-wet/">Docker - Getting Feet Wet - Build the LAMP Stack</a>
    </h1>
  

        <a href="/2015/08/docker-getting-feet-wet/" class="archive-article-date">
  	<time datetime="2015-08-28T03:22:02.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-08-28</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Setup-Docker-with-Vagrant"><a href="#Setup-Docker-with-Vagrant" class="headerlink" title="Setup Docker with Vagrant"></a>Setup Docker with <a href="https://www.vagrantup.com/" target="_blank" rel="external">Vagrant</a></h2><p>Get the vagrant-based docker env from <a href="https://atlas.hashicorp.com/ailispaw/boxes/docker-root" target="_blank" rel="external">DockerRoot Vagrant Box</a>, which is tiny (only 12 MB) and contains the lastest version of docker (Linux kernel v4.1.6 and GLIBC, Docker v1.8.1). The direct download address is <a href="https://atlas.hashicorp.com/ailispaw/boxes/docker-root/versions/1.0.0/providers/virtualbox.box" target="_blank" rel="external">https://atlas.hashicorp.com/ailispaw/boxes/docker-root/versions/1.0.0/providers/virtualbox.box</a>).</p>
<p>P.S. Some mini linux disto: <a href="http://tinycorelinux.net/" target="_blank" rel="external">Tiny Core Linux</a>(on which boot2docker is based), <a href="http://www.yoctoproject.org/" target="_blank" rel="external">yoctoproject</a>, <a href="http://www.busybox.net/" target="_blank" rel="external">BusyBox</a>, <a href="http://buildroot.uclibc.org/" target="_blank" rel="external">Buildroot</a>.</p>
<h2 id="Data-Only-Container-Container-as-Volumn-Pattern"><a href="#Data-Only-Container-Container-as-Volumn-Pattern" class="headerlink" title="Data-Only Container (Container-as-Volumn Pattern)"></a>Data-Only Container (Container-as-Volumn Pattern)</h2><p><a href="http://www.offermann.us/2013/12/tiny-docker-pieces-loosely-joined.html" target="_blank" rel="external">Tiny Docker Pieces, Loosely Joined</a>:</p>
<blockquote>
<p>Since I’ve spelled it out in such exhaustive detail, this may all seem like much ado about nothing…but, now that I finally grok the idea, I can see how data-only containers are so useful.</p>
<ul>
<li>It’s the simplest way to share data among multiple containers.</li>
<li>It makes it easy to upgrade the application (or process) that operates on the data. For example, say we wanted to generate PDF files in addition to HTML files. All we need to do to accomplish that is to create an updated pandoc-convert Docker image.</li>
<li>Adding additional processes that operate on the data is equally easy. What if you wanted to push the HTML files to an Amazon S3, in addition to serving them locally? Just create a new s3sync Docker image.</li>
</ul>
</blockquote>
<h2 id="Build-the-LAMP-Stack"><a href="#Build-the-LAMP-Stack" class="headerlink" title="Build the LAMP Stack"></a>Build the LAMP Stack</h2><h3 id="1-mysql-data-container"><a href="#1-mysql-data-container" class="headerlink" title="1. mysql data container"></a>1. mysql data container</h3><p>Build mysql-data image and run (as container):</p>
<pre><code>docker run --name cont-db-data mariadb echo &quot;Data-only container for mariadb&quot;
</code></pre><p>Note: not need to expose volume (<code>-v /var/lib/mysql</code>), see <a href="http://container-solutions.com/understanding-volumes-docker/" target="_blank" rel="external">http://container-solutions.com/understanding-volumes-docker/</a> for explaination.</p>
<p>To maint:</p>
<pre><code>SHX=&quot;bash --rcfile &lt;(echo &apos;PS1=\&quot;\n\e[1;34m[\t \u@\h \W]\e[m\n\$ \&quot;&apos;; echo &apos;alias ll=\&quot;ls -ltra --color=auto\&quot;&apos;)&quot;
docker exec -it cont-mariadb bash -c &quot;$SHX&quot;
</code></pre><p>Note: the <code>$SHX</code> here initializes the bash shell with <code>--rcfile</code> option (set the <code>PS1</code> shell variable and <code>ll</code> alias).</p>
<p>Or build with Dockerfile:</p>
<pre><code>cat &gt;&gt; $APPROOOT/dockerfiles/dbdata/Dockerfile &lt;&lt;EOF
FROM stackbrew/busybox:latest
MAINTAINER fouding zheng &lt;fouding.zheng@gmail.com&gt;

VOLUME /var/lib/mysql
CMD [&quot;true&quot;]
EOF
# KEY: volume is /var/lib/mysql, NOT arbitrary path!

sudo docker build -t fouding/docker-mysql-data $APPROOOT/dockerfiles/dbdata
sudo docker run --name cont-db-data fouding/docker-mysql-data true
</code></pre><h3 id="2-cont-app-data-container"><a href="#2-cont-app-data-container" class="headerlink" title="2. cont-app-data container"></a>2. cont-app-data container</h3><pre><code>HTMLROOT=/usr/share/nginx/html
docker run --name cont-app-data -v $HTMLROOT stackbrew/busybox:latest echo &quot;app data-only container&quot;
</code></pre><p>To maint the cont-app-data:</p>
<pre><code>docker run --rm --volumes-from cont-app-data -v /vagrant-dockerroot/:/app -it fouding/richarvey-nginx-php:addXdebug bash -c &quot;$SHX&quot;
docker run --rm --volumes-from cont-app-data -v /vagrant-dockerroot/:/app -it stackbrew/busybox:latest /bin/sh
</code></pre><p>Note: not <code>docker exec -it cont-app-data bash -c &quot;$SHX&quot;</code>, as the cont is not in running state.<br>Then:</p>
<pre><code>cp -r /app/iWshop /usr/share/nginx/html/
</code></pre><h3 id="3-db-mariadb-mysql-container"><a href="#3-db-mariadb-mysql-container" class="headerlink" title="3. db: mariadb(mysql) container"></a>3. db: mariadb(mysql) container</h3><pre><code>docker run --name cont-mariadb --volumes-from cont-db-data -e MYSQL_USER=iwshop -e MYSQL_PASSWORD=1wsh0p -e MYSQL_DATABASE=iwshop -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mariadb
</code></pre><p>To maint:</p>
<pre><code>docker exec -it cont-mariadb bash -c &quot;$SHX&quot;
</code></pre><p>OR</p>
<pre><code>docker run --rm --link cont-mariadb -it mariadb bash -c &quot;$SHX&quot;
</code></pre><p>If “TERM environment variable not set” error: <a href="https://github.com/dockerfile/mariadb/issues/3" target="_blank" rel="external">https://github.com/dockerfile/mariadb/issues/3</a> :</p>
<blockquote>
<p><code>docker exec -it mariadb bash</code><br><code>mysql</code><br>produces the following error message: TERM environment variable not set.</p>
<p>Unsure why since <code>echo $TERM</code> returns <code>dumb</code> and issuing <code>export TERM=dumb</code> resolves issue.</p>
<p>If the environment variable is explicitly issued in the dockerfile, the error message never appears, i.e. adding <code>ENV TERM dumb</code></p>
</blockquote>
<h3 id="4-web"><a href="#4-web" class="headerlink" title="4. web"></a>4. web</h3><p>nginx-php-fpm container:</p>
<pre><code>docker run --name cont-webserver -p 8000:80 --volumes-from cont-app-data --link cont-mariadb:mariadb -d fouding/richarvey-nginx-php
</code></pre><p>To maint:</p>
<pre><code>docker run -it --rm fouding/richarvey-nginx-php bash -c &quot;$SHX&quot;
docker run -it --rm fouding/richarvey-nginx-php bash -c &quot;bash --rcfile &lt;(echo &apos;PS1=\&quot;\n\e[1;34m[\t \u@ws \W]\e[m\n\$ \&quot;&apos;; echo &apos;alias ll=\&quot;ls -ltra --color=auto\&quot;&apos;)&quot;
</code></pre><h3 id="5-test"><a href="#5-test" class="headerlink" title="5. test"></a>5. test</h3><p>Create a simple php file:</p>
<pre><code>cat &gt;&gt; ~/app/php/index.php &lt;&lt; EOF
&lt;?php
    echo test php;
    phpinfo();
?&gt;
EOF
</code></pre><p>Open in browser: <a href="http://localhost:8000/" target="_blank" rel="external">http://localhost:8000</a>, or use cmdline: <code>curl -i http://localhost:8000</code>.</p>
<h3 id="6-access"><a href="#6-access" class="headerlink" title="6. access"></a>6. access</h3><pre><code>docker exec -it cont-webserver bash
</code></pre><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li>consider using the small phusion/baseimage image instead of the huge “ubuntu:14:04” image.</li>
</ul>
<h2 id="Docker-Usage-Summary"><a href="#Docker-Usage-Summary" class="headerlink" title="Docker Usage Summary"></a>Docker Usage Summary</h2><h3 id="2-ways-to-communicate-b-w-2-containers"><a href="#2-ways-to-communicate-b-w-2-containers" class="headerlink" title="2 ways to communicate b/w 2 containers:"></a>2 ways to communicate b/w 2 containers:</h3><ul>
<li>Via volumes: <code>cont-mariadb --volumes-from cont-db-data</code></li>
</ul>
<p>then the server can access the FILES in the dataCont => use as DATA STORAGE.</p>
<ul>
<li>Via container linking: <code>cont-webserver: --link cont-mariadb:mariadb</code></li>
</ul>
<p>then the server can ping/connect to the dataCont => use as mysql server.<br>KEY: dataCont: <code>-v guestVolume</code> to expose the vol, and server side: <code>--volume-from dataCont</code> [RI: not need to specify the volume here, which has been predefined by the <code>docker run -v /guestVolume dataCont</code>. The vol is: dataCont:guestVolume ]</p>
<h3 id="2-types"><a href="#2-types" class="headerlink" title="2 types:"></a>2 types:</h3><ul>
<li><code>docker run -d imgName</code></li>
<li><code>docker run -ti imgName bash</code></li>
</ul>
<h3 id="2-ways-to-start-a-container"><a href="#2-ways-to-start-a-container" class="headerlink" title="2 ways to start a container:"></a>2 ways to start a container:</h3><ul>
<li><code>docker run -i -t imgName cmd</code></li>
<li><code>docker run -d imgName</code> [no cmd appended]</li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/best-practice/">best practice</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/lamp/">lamp</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2015/08/docker-getting-feet-wet/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-build-dev-env-with-vagrant" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/build-dev-env-with-vagrant/">pomodoro 番茄工作法</a>
    </h1>
  

        <a href="/2015/08/build-dev-env-with-vagrant/" class="archive-article-date">
  	<time datetime="2015-08-20T08:23:01.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-08-20</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><ul>
<li>One of the most useful senario with Vagrant is to setup a network of serveral computing nodes to mimic a distributed system. Or even better, use <a href="https://www.docker.com/" target="_blank" rel="external">Docker</a>.</li>
</ul>
<h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><h3 id="Download-offline-file-for-instable-network-esp-in-case-u-r-behind-the-“greatwall”"><a href="#Download-offline-file-for-instable-network-esp-in-case-u-r-behind-the-“greatwall”" class="headerlink" title="Download offline file for instable network, esp. in case u r behind the “greatwall”:"></a>Download offline file for instable network, esp. in case u r behind the “greatwall”:</h3><p>Search the box in <a href="https://atlas.hashicorp.com/" target="_blank" rel="external">https://atlas.hashicorp.com/</a> for box name, version, then follow the format</p>
<pre><code>https://atlas.hashicorp.com/puppetlabs/boxes/&lt;boxName&gt;/versions/&lt;version&gt;/providers/virtualbox.box
</code></pre><p>to construct the downloading url. e.g. <a href="https://atlas.hashicorp.com/puppetlabs/boxes/centos-7.0-64-puppet/versions/1.0.2/providers/virtualbox.box" target="_blank" rel="external">https://atlas.hashicorp.com/puppetlabs/boxes/centos-7.0-64-puppet/versions/1.0.2/providers/virtualbox.box</a></p>
<h3 id="Change-the-Storage-Location"><a href="#Change-the-Storage-Location" class="headerlink" title="Change the Storage Location"></a>Change the Storage Location</h3><ul>
<li>Press <code>Win+R</code> and type <code>systempropertiesadvanced</code> to bring up the “System Properties” dialog, click “Environment Variables…” button, and in the “User vairalbes for $USER” section, add a variable named <code>VAGRANT_HOME</code>, whose value is <code>D:\your\vagrant\working\path</code>.</li>
</ul>
<p>Or use the command line:</p>
<pre><code>SETX VAGRANT_HOME &quot;D:\your\vagrant\working\path&quot;
</code></pre><ul>
<li>Change VirtualBox storage location: Open Virtalbox and navigate to <code>File &gt; Preference&gt; General: Default Machine Folder</code>: change to target location.</li>
</ul>
<h2 id="Setup-Vagrant-Virtual-Machine"><a href="#Setup-Vagrant-Virtual-Machine" class="headerlink" title="Setup Vagrant Virtual Machine"></a>Setup Vagrant Virtual Machine</h2><p>Execute below commands in <a href="http://cmder.net/" target="_blank" rel="external">cmder</a>/cmd.exe:</p>
<pre><code>echo check vagrant_home: %vagrant_home%
set BN=boot2docker-virtualbox
set BOXPATH=D:\tools\vagrant-boxes\boot2docker-virtualbox.box
cd /d D:\HashiCorp\Vagrant\myvagrantfile
mkdir %BN%
cd %BN%
vagrant box add %BN% %BOXPATH%
vagrant box list
vagrant init %BN%
</code></pre><p>And issue command <code>vagrant up &amp;&amp; vagrant ssh</code> to startup and connect to the vagrant vm and install the dev tools manually, then key in <code>vagrant package --output my-dev.box</code> to export the whole box as a file which can then be shared b/w team members to setup the same dev env quickly.<br>(If you are using <a href="http://cmder.net/" target="_blank" rel="external">cmder</a> full version, the <code>ssh</code> command is right in your hands, so simply type <code>vagrant ssh</code> to connect to the vagrant box; otherwise, use a ssh client, say Putty, MobaXterm.)</p>
<p>Or edit the <code>Vagrantfile</code> file to setup the dev env in script.</p>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><p>If both host-only network and shared folder are enabled in Vagrantfile:</p>
<pre><code>config.vm.network &quot;private_network&quot;, ip: &quot;192.168.33.15&quot;
config.vm.synced_folder &quot;e:&quot;, &quot;/host_e&quot;
</code></pre><p>The host-only network is accessible, but the synced_folder cannot be found! (I don’t know whether this bug is in Vagrant, or reproducible only in my machine)</p>
<p>Solution: create the <code>/host_e</code> directionary, then mount the drive in <code>~/.bashrc</code> file manually:</p>
<pre><code>echo &apos;sudo mount -t vboxsf -o uid=$UID,gid=$(id -g) host_e /host_e&apos; &gt;&gt; ~/.bashrc
</code></pre>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dev/">dev</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vagrant/">vagrant</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2015/08/build-dev-env-with-vagrant/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-pomodoro" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/08/pomodoro/">Pomodoro 番茄工作法</a>
    </h1>
  

        <a href="/2015/08/pomodoro/" class="archive-article-date">
  	<time datetime="2015-08-04T23:42:29.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-08-05</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="js"><a href="#js" class="headerlink" title="js"></a>js</h2><ul>
<li>app: <a href="https://itunes.apple.com/us/app/pomodoro-pomodoro-technique/id850080769" target="_blank" rel="external">Pomodoro</a> by Zheng Fu: a simple yet sufficient pomodoro tool.</li>
<li>begin of day: move activity from <em>Activity Inventory Sheet</em> to <em>Todo Today sheet</em>;</li>
<li>end of day: review</li>
<li>when finished a pomo: tag, cross finined task</li>
<li>4 pomo: longer rest (15-30min)</li>
<li>if interrupted: mark “`”</li>
</ul>
<h2 id="原则："><a href="#原则：" class="headerlink" title="原则："></a>原则：</h2><ul>
<li>尽早开始： 烂的开始是完成的一半</li>
<li>预留突发事情的时间</li>
<li>拆分：1z：各份真题，各份预测题</li>
<li>前有计划，后有总结</li>
<li>舍得：把做完的划掉；把用完的web/app关掉</li>
<li>一张图抓住时间管理的关键理念</li>
<li>清空脑袋</li>
</ul>
<h2 id="详细说明："><a href="#详细说明：" class="headerlink" title="详细说明："></a>详细说明：</h2><p>一、5样工具 </p>
<ol>
<li>番茄计时器</li>
<li>铅笔和橡皮</li>
<li>今日待办清单（to do today），包括一部分留给计划外的待办事件</li>
<li>活动清单（Activity Inventory）</li>
<li>记录单</li>
</ol>
<p>二、方法和步骤 </p>
<ol>
<li>把想要做的事情都记录在活动清单上，活动清单就像一个累积待办事项的仓库 </li>
<li>每天早上从活动清单中挑选今天想做的事情抄入今日待办清单，按重要性排序并估测大致需要的番茄数 </li>
<li>在今日待办清单上选出最重要的一件 </li>
<li>开始一个番茄时间，倒计时25分钟，专注于你的工作，直到铃声响起 </li>
<li>尽量保护你的番茄时间别被打断，如果有新想法或外部干扰，先记录下来，留到铃响之后处理 </li>
<li>每个番茄时间结束后休息3-5分钟，4个番茄时间算一轮结束后休息15-30分钟 </li>
<li>已经做完的事及时划掉 </li>
<li>一天结束后在记录单中记录自己完成的番茄数，被打断的次数等等信息 </li>
<li>将计划外且没完成的工作记回活动清单 </li>
<li>分析和思考看看是否有需要改进 </li>
</ol>
<p>Ref:</p>
<ul>
<li><a href="http://www.douban.com/group/topic/28655523/" target="_blank" rel="external">番茄工作法学习笔记</a></li>
<li><a href="http://www.pureweber.com/article/gtd-introduction/" target="_blank" rel="external">什么是GTD？（GTD是关于什么的?）</a></li>
<li><a href="http://www.gtdlife.com/2014/3636/one-pic-time-management/" target="_blank" rel="external">一张图抓住时间管理的关键理念</a></li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gtd/">gtd</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2015/08/pomodoro/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-new-family-member" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/new-family-member/">Welcome New Family Member</a>
    </h1>
  

        <a href="/2015/07/new-family-member/" class="archive-article-date">
  	<time datetime="2015-07-25T14:22:22.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-07-25</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>We are blessed with a cute girl on 24, Jun. Welcome, lele, the whole family are happy and enjoying with u!</p>
<p>Love u, zz! U r the world to me.</p>
<p>There is no place like ~.</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/family/">family</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2015/07/new-family-member/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-nginx-modsecurity-installation" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/nginx-modsecurity-installation/">CentOS 上 Nginx 安装 modSecurity 模块</a>
    </h1>
  

        <a href="/2015/03/nginx-modsecurity-installation/" class="archive-article-date">
  	<time datetime="2015-03-01T13:28:47.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-03-01</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Web应用防火墙-WAF"><a href="#Web应用防火墙-WAF" class="headerlink" title="Web应用防火墙 WAF"></a>Web应用防火墙 WAF</h2><p>Web应用防护系统（Web Application Firewall, 简称：WAF）代表了一类新兴的信息安全技术，用以解决诸如防火墙一类传统设备束手无策的Web应用安全问题。与传统防火墙不同，WAF工作在应用层，因此对Web应用防护具有先天的技术优势。基于对Web应用业务和逻辑的深刻理解，WAF对来自Web应用程序客户端的各类请求进行内容检测和验证，确保其安全性与合法性，对非法的请求予以实时阻断，从而对各类网站站点进行有效防护。 </p>
<p>ModSecurity是一个入侵侦测与防护引擎，其目的是为增强Web应用程序的安全性和保护Web应用程序避免遭受来自已知与未知的攻击。</p>
<h2 id="Nginx-安装-modSecurity-模块"><a href="#Nginx-安装-modSecurity-模块" class="headerlink" title="Nginx 安装 modSecurity 模块"></a>Nginx 安装 modSecurity 模块</h2><ol>
<li>安装依赖</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">su</div><div class="line"></div><div class="line">yum install -y gcc make automake autoconf libtool</div><div class="line">yum install -y pcre pcre-devel libxml2 libxml2-devel curl curl-devel httpd-devel</div></pre></td></tr></table></figure>
<p>2. 编译 modSecurity</p>
<p>首先到 modSecurity 官网上下载最新版并编译：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">wget https://www.modsecurity.org/tarball/2.9.0/modsecurity-2.9.0.tar.gz</div><div class="line"></div><div class="line">tar -xvpzf modsecurity-2.9.0.tar.gz</div><div class="line"><span class="built_in">cd</span> modsecurity-2.9.0</div><div class="line"></div><div class="line">./autogen.sh</div><div class="line">./configure --enable-standalone-module</div><div class="line">make</div></pre></td></tr></table></figure>
<p>会花1分钟左右的时间去编译。</p>
<p>3. 将 modSecurity 模块打包进 nginx</p>
<p>要从源码层级将 modSecurity 模块编译进 nginx。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~</div><div class="line">wget http://nginx.org/download/nginx-1.7.8.tar.gz</div><div class="line">tar -xvpzf nginx-1.7.8.tar.gz</div><div class="line"><span class="built_in">cd</span> nginx-1.7.8</div><div class="line">./configure --add-module=../modsecurity-2.9.0/nginx/modsecurity/</div><div class="line">make</div><div class="line">make install</div><div class="line"></div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/nginx/sbin</div></pre></td></tr></table></figure>
<p>安装后，nginx 位于 <code>/usr/local/nginx/sbin/nginx</code>。</p>
<p>4. 启用 modSecurity</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/nginx</div><div class="line">vi conf/nginx.conf</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">	ModSecurityEnabled on;</div><div class="line">	ModSecurityConfig modsecurity.conf;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面指定了modSecurity 的配置文件为 modsecurity.conf，下面来创建它：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># create am empty modsecurity.conf</span></div><div class="line">touch conf/modsecurity.conf</div><div class="line"><span class="comment"># test the conf file</span></div><div class="line">sudo ./nginx -t</div></pre></td></tr></table></figure>
<p>参考：</p>
<ul>
<li><a href="http://baike.baidu.com/link?url=lxg5knLVTwZ2vbth76MM5aXtFCv16VOW6dNekXyqKtwRzwUs1qcUM6MrtrvjSCmWlenY0W6t_8a1iDhqqR9aba" target="_blank" rel="external">百度百科</a></li>
<li><a href="http://www.nginxtips.com/how-to-install-mod_security-on-nginx/" target="_blank" rel="external">How to install Mod_Security on Nginx</a></li>
</ul>
<h2 id="nbsp"><a href="#nbsp" class="headerlink" title="&nbsp;"></a>&nbsp;</h2>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/centos/">centos</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/modSecurity/">modSecurity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/waf/">waf</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-book icon"></i>
	<a class="article-category-link" href="/categories/tech/">tech</a>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2015/03/nginx-modsecurity-installation/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-linux-utilities" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/linux-utilities/">Linux Utilities</a>
    </h1>
  

        <a href="/2015/03/linux-utilities/" class="archive-article-date">
  	<time datetime="2015-03-01T09:08:45.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-03-01</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="network"><a href="#network" class="headerlink" title="network"></a>network</h2><h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><p>Post a file:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -D - -F key1=value1 -F uploadedFile=@E:\abc.txt http://foo.com/post</div></pre></td></tr></table></figure></p>
<pre><code>curl -H &quot;Content-Type: application/json&quot; -d &apos;{&quot;username&quot;:&quot;xyz&quot;,&quot;password&quot;:&quot;xyz&quot;}&apos; http://foo.com/api/login
</code></pre><p>For windows, single quotes around json did not work and I ended up escaping double quotes.<br>    curl -X POST -H “Content-Type: application/json” -d “{ \”key1\”: \”value1\” }” <a href="http://foo.com/api/method" target="_blank" rel="external">http://foo.com/api/method</a></p>
<h2 id="text-browsers"><a href="#text-browsers" class="headerlink" title="text browsers"></a>text browsers</h2><p><a href="http://elinks.or.cz/" target="_blank" rel="external">elinks</a>, <a href="http://lynx.isc.org/" target="_blank" rel="external">lynx</a>, etc.</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-book icon"></i>
	<a class="article-category-link" href="/categories/tech/">tech</a>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2015/03/linux-utilities/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Troubleshooting-POST-data-cannot-be-read-from-HttpServletRequest" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/Troubleshooting-POST-data-cannot-be-read-from-HttpServletRequest/">Troubleshooting: POST Data Cannot Be Read From HttpServletRequest</a>
    </h1>
  

        <a href="/2015/02/Troubleshooting-POST-data-cannot-be-read-from-HttpServletRequest/" class="archive-article-date">
  	<time datetime="2015-02-13T07:24:46.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-02-13</time>
</a>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>遇到一个奇怪的问题：明明客户端有 POST 数据到服务端，但服务端就是“获取不到”数据。相关的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"goodsOrder"</span>, method = RequestMethod.POST)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">goodsOrder</span><span class="params">(HttpServletRequest request, @RequestParam(value=<span class="string">"page"</span>, required=<span class="keyword">false</span>, defaultValue=<span class="string">"1"</span>)</span> <span class="keyword">int</span> page)</span></div><div class="line">	<span class="keyword">byte</span>[] postBytes = IOUtils.toByteArray(request.getInputStream());</div><div class="line">	</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此处，取到的 <code>postBytes</code> 总为空，而不是用户提交的数据。</p>
<h2 id="原因及解决"><a href="#原因及解决" class="headerlink" title="原因及解决"></a>原因及解决</h2><p>使用 Spring <code>@RequestParam</code> 来注入参数时，Spring 会去读取 <code>HttpServletRequest request</code> 的值，而request.getInputStream() 只能读取一次，所以就造成第二次去读参数时，获取不到数据了。</p>
<p>注意：<code>ServletRequest.getParameter()</code> 等方法也会隐式地读取请求数据，数据读取一次后得将其保存起来，因为不能再重新获取了。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringMVC/">SpringMVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/troubleshooting/">troubleshooting</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-book icon"></i>
	<a class="article-category-link" href="/categories/tech/">tech</a>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2015/02/Troubleshooting-POST-data-cannot-be-read-from-HttpServletRequest/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 foudingzh
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js?v=4.0.0.js"></script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">troubleshooting</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">SpringMVC</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">logging</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">linux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">port</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">vagrant</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">dev</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">docker</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">best practice</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">lamp</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">shell</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">python</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">sqlite</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">script</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">utility</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">code snippet</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">family</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">maven</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">nginx</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">mgmt</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">dev phases</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">toolchain</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">tomcat</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">deploy</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">centos</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">waf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">modSecurity</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">gtd</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">win</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">cmd</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">web</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">spring</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">encryption</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">architecture</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">foss</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)">vim</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            2、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://www.quora.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>Quora</a>
            </li>
          
            <li class="search-li">
              <a href="http://stackoverflow.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>stackoverflow</a>
            </li>
          
            <li class="search-li">
              <a href="https://github.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>github</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.zhihu.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>知乎</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.jianshu.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>简书</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.oschina.net" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>开源中国</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.infoq.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>InfoQ</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">Hello, I&#39;m Fouding based in Xiamen, China. &lt;br&gt;This is my blog about life, career and technologies.</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>